"use strict";var e=require("../core/TempNode.cjs.js");require("../core/Node.cjs.js"),require("../core/constants.cjs.js"),require("../core/NodeUtils.cjs.js"),require("three");class t extends e{constructor(e,o,r,...i){if(super(),this.op=e,i.length>0){let o=r;for(let r=0;r<i.length;r++)o=new t(e,o,i[r]);r=o}this.aNode=o,this.bNode=r}getNodeType(e,t){const o=this.op,r=this.aNode,i=this.bNode,s=r.getNodeType(e),d=i.getNodeType(e);if("void"===s||"void"===d)return"void";if("="===o||"%"===o)return s;if("&"===o||"|"===o||"^"===o||">>"===o||"<<"===o)return"int";if("=="===o||"&&"===o||"||"===o||"^^"===o)return"bool";if("<"===o||">"===o||"<="===o||">="===o){const o=e.getTypeLength(t);return o>1?`bvec${o}`:"bool"}return"float"===s&&e.isMatrix(d)?d:e.isMatrix(s)&&e.isVector(d)?e.getVectorFromMatrix(s):e.isVector(s)&&e.isMatrix(d)?e.getVectorFromMatrix(d):e.getTypeLength(d)>e.getTypeLength(s)?d:s}generate(e,t){const o=this.op,r=this.aNode,i=this.bNode,s=this.getNodeType(e,t);let d=null,a=null;"void"!==s?(d=r.getNodeType(e),a=i.getNodeType(e),"="===o?a=d:"<"===o||">"===o||"<="===o||">="===o?e.isVector(d)?a=d:d=a="float":e.isMatrix(d)&&e.isVector(a)?a=e.getVectorFromMatrix(d):d=e.isVector(d)&&e.isMatrix(a)?e.getVectorFromMatrix(a):a=s):d=a=s;const n=r.build(e,d),c=i.build(e,a),h=e.getTypeLength(t);return"void"!==t?"="===o?(e.addFlowCode(`${n} ${this.op} ${c}`),n):">"===o&&h>1?e.format(`${e.getMethod("greaterThan")}( ${n}, ${c} )`,s,t):"<="===o&&h>1?e.format(`${e.getMethod("lessThanEqual")}( ${n}, ${c} )`,s,t):e.format(`( ${n} ${this.op} ${c} )`,s,t):"void"!==d?e.format(`${n} ${this.op} ${c}`,s,t):void 0}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}module.exports=t;
