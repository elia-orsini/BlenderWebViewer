"use strict";var e=require("@babel/runtime/helpers/defineProperty"),t=require("three"),r=require("../core/Node.cjs.js"),o=require("../core/UniformNode.cjs.js"),i=require("../core/constants.cjs.js");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../core/NodeUtils.cjs.js"),require("../core/InputNode.cjs.js");var a=s(e);class u extends r{constructor(e=u.VIEW_MATRIX,t=null){super(),this.scope=e,this.object3d=t,this.updateType=i.NodeUpdateType.Object,this._uniformNode=new o(null)}getNodeType(){const e=this.scope;return e===u.WORLD_MATRIX||e===u.VIEW_MATRIX?"mat4":e===u.NORMAL_MATRIX?"mat3":e===u.POSITION||e===u.VIEW_POSITION?"vec3":void 0}update(e){const t=null!==this.object3d?this.object3d:e.object,r=this._uniformNode,o=e.camera,i=this.scope;i===u.VIEW_MATRIX?r.value=t.modelViewMatrix:i===u.NORMAL_MATRIX?r.value=t.normalMatrix:i===u.WORLD_MATRIX?r.value=t.matrixWorld:i===u.POSITION?r.value.setFromMatrixPosition(t.matrixWorld):i===u.VIEW_POSITION&&(r.value.setFromMatrixPosition(t.matrixWorld),r.value.applyMatrix4(o.matrixWorldInverse))}generate(e){const r=this.scope;return r===u.WORLD_MATRIX||r===u.VIEW_MATRIX?this._uniformNode.nodeType="mat4":r===u.NORMAL_MATRIX?this._uniformNode.nodeType="mat3":r!==u.POSITION&&r!==u.VIEW_POSITION||(this._uniformNode.nodeType="vec3",this._uniformNode.value=new t.Vector3),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}a.default(u,"VIEW_MATRIX","viewMatrix"),a.default(u,"NORMAL_MATRIX","normalMatrix"),a.default(u,"WORLD_MATRIX","worldMatrix"),a.default(u,"POSITION","position"),a.default(u,"VIEW_POSITION","viewPosition"),module.exports=u;
