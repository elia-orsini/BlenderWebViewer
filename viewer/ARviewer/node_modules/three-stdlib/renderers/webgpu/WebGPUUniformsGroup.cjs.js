"use strict";var t=require("./WebGPUBinding.cjs.js"),e=require("./constants.cjs.js");module.exports=class extends t{constructor(t){super(t),this.uniforms=[],this.onBeforeUpdate=function(){},this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this.type=e.GPUBindingType.UniformBuffer,this.visibility=GPUShaderStage.VERTEX,this.usage=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,this.array=null,this.bufferGPU=null,Object.defineProperty(this,"isUniformsGroup",{value:!0})}addUniform(t){return this.uniforms.push(t),this}removeUniform(t){const e=this.uniforms.indexOf(t);return-1!==e&&this.uniforms.splice(e,1),this}setOnBeforeUpdate(t){return this.onBeforeUpdate=t,this}getByteLength(){let t=0;for(let e=0,r=this.uniforms.length;e<r;e++){const r=this.uniforms[e],s=t%16,i=16-s;0!==s&&i-r.boundary<0&&(t+=16-s),r.offset=t/this.bytesPerElement,t+=r.itemSize*this.bytesPerElement}return t}update(){let t=!1;for(let e of this.uniforms)!0===this.updateByType(e)&&(t=!0);return t}updateByType(t){return t.isFloatUniform?this.updateNumber(t):t.isVector2Uniform?this.updateVector2(t):t.isVector3Uniform?this.updateVector3(t):t.isVector4Uniform?this.updateVector4(t):t.isColorUniform?this.updateColor(t):t.isMatrix3Uniform?this.updateMatrix3(t):t.isMatrix4Uniform?this.updateMatrix4(t):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",t)}updateNumber(t){let e=!1;const r=this.array,s=t.getValue(),i=t.offset;return r[i]!==s&&(r[i]=s,e=!0),e}updateVector2(t){let e=!1;const r=this.array,s=t.getValue(),i=t.offset;return r[i+0]===s.x&&r[i+1]===s.y||(r[i+0]=s.x,r[i+1]=s.y,e=!0),e}updateVector3(t){let e=!1;const r=this.array,s=t.getValue(),i=t.offset;return r[i+0]===s.x&&r[i+1]===s.y&&r[i+2]===s.z||(r[i+0]=s.x,r[i+1]=s.y,r[i+2]=s.z,e=!0),e}updateVector4(t){let e=!1;const r=this.array,s=t.getValue(),i=t.offset;return r[i+0]===s.x&&r[i+1]===s.y&&r[i+2]===s.z&&r[i+4]===s.w||(r[i+0]=s.x,r[i+1]=s.y,r[i+2]=s.z,r[i+3]=s.w,e=!0),e}updateColor(t){let e=!1;const r=this.array,s=t.getValue(),i=t.offset;return r[i+0]===s.r&&r[i+1]===s.g&&r[i+2]===s.b||(r[i+0]=s.r,r[i+1]=s.g,r[i+2]=s.b,e=!0),e}updateMatrix3(t){let e=!1;const r=this.array,s=t.getValue().elements,i=t.offset;return r[i+0]===s[0]&&r[i+1]===s[1]&&r[i+2]===s[2]&&r[i+4]===s[3]&&r[i+5]===s[4]&&r[i+6]===s[5]&&r[i+8]===s[6]&&r[i+9]===s[7]&&r[i+10]===s[8]||(r[i+0]=s[0],r[i+1]=s[1],r[i+2]=s[2],r[i+4]=s[3],r[i+5]=s[4],r[i+6]=s[5],r[i+8]=s[6],r[i+9]=s[7],r[i+10]=s[8],e=!0),e}updateMatrix4(t){let e=!1;const r=this.array,s=t.getValue().elements,i=t.offset;return!1===function(t,e,r){for(let s=0,i=e.length;s<i;s++)if(t[r+s]!==e[s])return!1;return!0}(r,s,i)&&(r.set(s,i),e=!0),e}};
