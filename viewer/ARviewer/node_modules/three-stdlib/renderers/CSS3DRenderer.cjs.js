"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),t=function(t){e.Object3D.call(this),this.element=t||document.createElement("div"),this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))};t.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:t,copy:function(t,r){return e.Object3D.prototype.copy.call(this,t,r),this.element=t.element.cloneNode(!0),this}});var r=function(e){t.call(this,e)};(r.prototype=Object.create(t.prototype)).constructor=r;exports.CSS3DObject=t,exports.CSS3DRenderer=function(){var n,o,s,a,i=this,l=new e.Matrix4,c={camera:{fov:0,style:""},objects:new WeakMap},p=document.createElement("div");p.style.overflow="hidden",this.domElement=p;var d=document.createElement("div");function m(e){return Math.abs(e)<1e-10?0:e}function h(e){var t=e.elements;return"matrix3d("+m(t[0])+","+m(-t[1])+","+m(t[2])+","+m(t[3])+","+m(t[4])+","+m(-t[5])+","+m(t[6])+","+m(t[7])+","+m(t[8])+","+m(-t[9])+","+m(t[10])+","+m(t[11])+","+m(t[12])+","+m(-t[13])+","+m(t[14])+","+m(t[15])+")"}function u(e){var t=e.elements;return"translate(-50%,-50%)"+("matrix3d("+m(t[0])+","+m(t[1])+","+m(t[2])+","+m(t[3])+","+m(-t[4])+","+m(-t[5])+","+m(-t[6])+","+m(-t[7])+","+m(t[8])+","+m(t[9])+","+m(t[10])+","+m(t[11])+","+m(t[12])+","+m(t[13])+","+m(t[14])+","+m(t[15])+")")}function v(e,n,o,s){if(e instanceof t){var a;e.onBeforeRender(i,n,o),e instanceof r?(l.copy(o.matrixWorldInverse),l.transpose(),l.copyPosition(e.matrixWorld),l.scale(e.scale),l.elements[3]=0,l.elements[7]=0,l.elements[11]=0,l.elements[15]=1,a=u(l)):a=u(e.matrixWorld);var p=e.element,m=c.objects.get(e);if(void 0===m||m.style!==a){p.style.transform=a;var h={style:a};c.objects.set(e,h)}p.style.display=e.visible?"":"none",p.parentNode!==d&&d.appendChild(p),e.onAfterRender(i,n,o)}for(let t=0,r=e.children.length;t<r;t++)v(e.children[t],n,o)}d.style.transformStyle="preserve-3d",d.style.pointerEvents="none",p.appendChild(d),this.getSize=function(){return{width:n,height:o}},this.setSize=function(e,t){s=(n=e)/2,a=(o=t)/2,p.style.width=e+"px",p.style.height=t+"px",d.style.width=e+"px",d.style.height=t+"px"},this.render=function(e,t){var r=t.projectionMatrix.elements[5]*a;if(c.camera.fov!==r&&(p.style.perspective=t.isPerspectiveCamera?r+"px":"",c.camera.fov=r),!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera)var n=-(t.right+t.left)/2,o=(t.top+t.bottom)/2;var i=(t.isOrthographicCamera?"scale("+r+")translate("+m(n)+"px,"+m(o)+"px)"+h(t.matrixWorldInverse):"translateZ("+r+"px)"+h(t.matrixWorldInverse))+"translate("+s+"px,"+a+"px)";c.camera.style!==i&&(d.style.transform=i,c.camera.style=i),v(e,e,t)}},exports.CSS3DSprite=r;
